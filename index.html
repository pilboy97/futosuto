<!DOCTYPE html>
<html>
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
        <link href="index.css" rel="stylesheet" /> 
    </head>
    <body>
        <div id="game">
            <div id="loc" class="gowun-dodum-regular"></div>
            <div id="name" class="gowun-dodum-regular"></div>
            <div id="text" class="gowun-dodum-regular"></div>
            <div id="opt" class="gowun-dodum-regular"></div>
        </div>
        <script type="module">
            import {init, getPrintLine, Screen} from "./script.js"
            import tokenize from "./token.js"
            import parse from "./parser.js"
            import { Engine } from "./engine.js"

            init()
            .then((script)=>{
                console.log(script)

                script = tokenize(script)
                console.log(script)

                script = parse(script)
                console.log(script)

                let vars = {}
                for(let i = 0;i < script.length;i++) {
                    vars[script.name] = script
                }

                let idx = 0
                let gameDiv = document.getElementById('game')
                let locDiv = document.getElementById("loc")
                let nameDiv = document.getElementById("name")
                let textDiv = document.getElementById("text")
                let optDiv = document.getElementById("opt")
                
                let screen = new Screen(gameDiv, locDiv, nameDiv, textDiv, optDiv)
                let engine = new Engine(vars, screen)

                screen.setEngine(engine)

                function onClick() {
                }

                gameDiv.addEventListener('click', onClick)

                onClick()
            })
        </script>
    </body>
</html>